---
title: "Week11 R Code - Anly 506-51"
author: "Nitin"
date: "July 24, 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r pressure, echo=FALSE}

```


#Principal Component Analysis in R

```{r}
mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)

summary(mtcars.pca)
```

```{r}
str(mtcars.pca)
```

```{r}
library(devtools)
install_github("vqv/ggbiplot")

```

##Plotting PCA (Principal Component Analysis)

```{r}
library(ggfortify)
df3<-prcomp(mtcars[,c(1:7,10,11)], center = TRUE, scale. = TRUE)
autoplot(df3)
```

Colorize by non-numeric values
```{r}
autoplot(df3, data = mtcars, colour = 'mpg')
```

Passing label = TRUE draws each data label using rownames

```{r}
autoplot(df3, data = mtcars, colour = 'mpg', label = TRUE, label.size = 4)
```

Passing shape = FALSE makes plot without points. In this case, label is turned on unless otherwise specified.

```{r}
autoplot(df3, data = mtcars, colour = 'mpg', shape = FALSE, label.size = 4)

```
 Drawing eigenvectors.
```{r}
autoplot(df3, data = mtcars, colour = 'mpg', loadings = TRUE)
```

Attaching lables to eigenvector and changing some options.

```{r}
autoplot(df3, data = mtcars, colour = 'mpg', 
         loadings = TRUE, loadings.colour = 'blue',
         loadings.label = TRUE, loadings.label.size = 4)
```

Disable scaling by specifying scale = 0

```{r}
autoplot((df3), scale = 0)
```

##Plotting Factor Analysis
```{r}
d.factanal <- factanal(mtcars, factors = 6, scores = 'regression')
autoplot(d.factanal, data = mtcars, colour = 'mpg')
```

Visualize both the principal component coefficients for each variable and the principal componen.

```{r}
autoplot(d.factanal, label = TRUE, label.size = 4,
         loadings = TRUE, loadings.label = TRUE, loadings.label.size  = 4)
```

##Plotting K-means

```{r}
set.seed(1)
autoplot(kmeans(mtcars, 6), data = mtcars)

```

```{r}
autoplot(kmeans(mtcars, 3), data = mtcars, label = TRUE, label.size = 3)
```

##Plotting cluster package

```{r}
library(cluster)
autoplot(clara(mtcars[-6], 6))

```
Drawing convex for each cluster
```{r}
autoplot(fanny(mtcars[-6], 6), frame = TRUE)
```

Drawing ellipse for each cluster

```{r}
autoplot(pam(mtcars[-6], 6), frame = TRUE, frame.type = 'norm')
```

